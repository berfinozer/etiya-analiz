SELECT * FROM Products WHERE unitprice = (SELECT MAX(unitprice) FROM Products);
SELECT * FROM Orders WHERE orderdate = (SELECT MAX(orderdate) FROM Orders);
SELECT * FROM Products WHERE UnitPrice > (SELECT AVG(UnitPrice) FROM Products);
SELECT P.ProductID, P.ProductName, C.CategoryName FROM Products P JOIN Categories C ON P.CategoryID = C.CategoryID WHERE C.CategoryName IN ('Seafood', 'Produce');
SELECT c.CategoryName, p.ProductName,  p.UnitPrice FROM Categories c JOIN  Products p ON c.CategoryID = p.CategoryID WHERE  p.UnitPrice = (SELECT MAX(UnitPrice) FROM Products) ORDER BY c.CategoryName;
SELECT o.OrderID,  o.OrderDate, c.CustomerID,c.ContactName  FROM Orders o JOIN Customers c ON o.CustomerID = c.CustomerID WHERE  c.Country = 'Spain';
SELECT p.ProductName,  p.UnitPrice,  c.CategoryName FROM  Products p JOIN Categories c ON p.CategoryID = c.CategoryID WHERE  p.UnitPrice > (SELECT AVG(UnitPrice) FROM Products WHERE CategoryID = p.CategoryID);
SELECT c.CustomerID,  c.ContactName,  o.OrderID,   o.OrderDate FROM  Customers c JOIN  Orders o ON c.CustomerID = o.CustomerID WHERE  o.OrderDate = (SELECT MAX(OrderDate) FROM Orders WHERE CustomerID = c.CustomerID );
SELECT e.EmployeeID, e.FirstName, e.LastName, COUNT(o.OrderID) AS TotalOrders FROM Employees e JOIN Orders o ON e.EmployeeID = o.EmployeeID GROUP BY e.EmployeeID, e.FirstName, e.LastName ORDER BY TotalOrders DESC LIMIT 1;
SELECT o.OrderID, o.CustomerID, o.OrderDate, SUM(od.Quantity) AS TotalQuantity FROM Orders o JOIN "Order Details" od ON o.OrderID = od.OrderID GROUP BY o.OrderID, o.CustomerID, o.OrderDate HAVING SUM(od.Quantity) >= 10;
SELECT c.CategoryName, MAX(p.UnitPrice) AS MaxPrice FROM Products p JOIN  Categories c ON p.CategoryID = c.CategoryID GROUP BY  c.CategoryName;
SELECT c.CustomerID, c.ContactName, COUNT(o.OrderID) AS TotalOrders FROM Customers c LEFT JOIN  Orders o ON c.CustomerID = o.CustomerID GROUP BY  c.CustomerID, c.ContactName ORDER BY TotalOrders DESC;
SELECT c.CustomerID,  c.ContactName, COUNT(o.OrderID) AS TotalOrders, MAX(o.OrderDate) AS LastOrderDate FROM  Customers c JOIN  Orders o ON c.CustomerID = o.CustomerID GROUP BY  c.CustomerID, c.ContactName ORDER BY TotalOrders DESC LIMIT 5;
SELECT c.CategoryName,  COUNT(p.ProductID) AS ProductCount FROM Categories c JOIN Products p ON c.CategoryID = p.CategoryID GROUP BY c.CategoryName HAVING COUNT(p.ProductID) > 8;
SELECT c.CustomerID, c.CompanyName, COUNT(DISTINCT od.ProductID) AS UniqueProducts FROM Customers c JOIN Orders o ON c.CustomerID = o.CustomerID JOIN "Order Details" od ON o.OrderID = od.OrderID GROUP BY c.CustomerID, c.CompanyName HAVING COUNT(DISTINCT od.ProductID) <= 5;
SELECT s.supplierid,s.CompanyName from Suppliers s  JOIN Products p on s.SupplierID=p.SupplierID  GROUP By s.SupplierID HAVING COUNT(p.ProductID)>1;
SELECT Customers.CompanyName, Products.ProductName, MAX("Order Details".UnitPrice) AS MaxPrice FROM Customers JOIN Orders ON Customers.CustomerID = Orders.CustomerID JOIN "Order Details" ON Orders.OrderID = "Order Details".OrderID JOIN Products ON "Order Details".ProductID = Products.ProductID GROUP BY Customers.CompanyName;
SELECT e.EmployeeID, e.FirstName, e.LastName, SUM(od.Quantity * p.UnitPrice) AS TotalOrderValue FROM Employees e JOIN Orders o ON e.EmployeeID = o.EmployeeID JOIN "Order Details" od ON o.OrderID = od.OrderID JOIN Products p ON od.ProductID = p.ProductID GROUP BY e.EmployeeID, e.FirstName, e.LastName HAVING SUM(od.Quantity * p.UnitPrice) > 10000;
SELECT p.CategoryID, p.ProductName, SUM(od.Quantity) AS TotalOrdered FROM Products p JOIN "Order Details" od ON p.ProductID = od.ProductID GROUP BY p.CategoryID, p.ProductID HAVING SUM(od.Quantity) = ( SELECT MAX(total) FROM (SELECT SUM(od2.Quantity) AS total  FROM Products p2 JOIN "Order Details" od2 ON p2.ProductID = od2.ProductID WHERE p2.CategoryID = p.CategoryID  GROUP BY p2.ProductID ));
SELECT DISTINCT c.CustomerID, c.CompanyName, p.ProductName, o.OrderDate FROM Customers c JOIN Orders o ON c.CustomerID = o.CustomerID JOIN "Order Details" od ON o.OrderID = od.OrderID JOIN Products p ON od.ProductID = p.ProductID WHERE o.OrderDate IN (  SELECT MAX(OrderDate) FROM Orders GROUP BY CustomerID );
SELECT Employees.FirstName || ' ' || Employees.LastName AS EmployeeName, Orders.OrderID, MAX("Order Details".UnitPrice * "Order Details".Quantity) AS MaxOrderValue, MAX(Orders.OrderDate) AS OrderDate FROM Employees JOIN Orders ON Employees.EmployeeID = Orders.EmployeeID JOIN "Order Details" ON Orders.OrderID = "Order Details".OrderID GROUP BY Employees.EmployeeID;
SELECT p.ProductID, p.ProductName, p.CategoryID, SUM(od.Quantity) AS TotalOrdered FROM Products p JOIN "Order Details" od ON p.ProductID = od.ProductID JOIN Orders o ON od.OrderID = o.OrderID GROUP BY p.ProductID, p.ProductName, p.CategoryID ORDER BY TotalOrdered DESC LIMIT 1;
